import{K as X,l as P,k as L,au as R,an as Z,am as G,o as j,r as c,Q as q,av as H,aw as I,O as K,ax as N,ay as Q,az as J,$ as Y,R as d,aq as v,ar as V}from"./index-7b052dbb.js";import{O as tt}from"./OrbitControls-c3d1e702.js";class et extends X{constructor(l,f,p,g){super();const x=[],A=[],B=[],i=new P,O=new L;O.makeRotationFromEuler(p),O.setPosition(f);const z=new L;z.copy(O).invert(),k(),this.setAttribute("position",new R(x,3)),this.setAttribute("normal",new R(A,3)),this.setAttribute("uv",new R(B,2));function k(){let t,e=[];const r=new P,a=new P;if(l.geometry.isGeometry===!0){console.error("THREE.DecalGeometry no longer supports THREE.Geometry. Use BufferGeometry instead.");return}const n=l.geometry,w=n.attributes.position,b=n.attributes.normal;if(n.index!==null){const m=n.index;for(t=0;t<m.count;t++)r.fromBufferAttribute(w,m.getX(t)),a.fromBufferAttribute(b,m.getX(t)),M(e,r,a)}else for(t=0;t<w.count;t++)r.fromBufferAttribute(w,t),a.fromBufferAttribute(b,t),M(e,r,a);for(e=h(e,i.set(1,0,0)),e=h(e,i.set(-1,0,0)),e=h(e,i.set(0,1,0)),e=h(e,i.set(0,-1,0)),e=h(e,i.set(0,0,1)),e=h(e,i.set(0,0,-1)),t=0;t<e.length;t++){const m=e[t];B.push(.5+m.position.x/g.x,.5+m.position.y/g.y),m.position.applyMatrix4(O),x.push(m.position.x,m.position.y,m.position.z),A.push(m.normal.x,m.normal.y,m.normal.z)}}function M(t,e,r){e.applyMatrix4(l.matrixWorld),e.applyMatrix4(z),r.transformDirection(l.matrixWorld),t.push(new C(e.clone(),r.clone()))}function h(t,e){const r=[],a=.5*Math.abs(g.dot(e));for(let n=0;n<t.length;n+=3){let w,b,m,F=0,u,y,E,D;const S=t[n+0].position.dot(e)-a,_=t[n+1].position.dot(e)-a,$=t[n+2].position.dot(e)-a;switch(w=S>0,b=_>0,m=$>0,F=(w?1:0)+(b?1:0)+(m?1:0),F){case 0:{r.push(t[n]),r.push(t[n+1]),r.push(t[n+2]);break}case 1:{if(w&&(u=t[n+1],y=t[n+2],E=s(t[n],u,e,a),D=s(t[n],y,e,a)),b){u=t[n],y=t[n+2],E=s(t[n+1],u,e,a),D=s(t[n+1],y,e,a),r.push(E),r.push(y.clone()),r.push(u.clone()),r.push(y.clone()),r.push(E.clone()),r.push(D);break}m&&(u=t[n],y=t[n+1],E=s(t[n+2],u,e,a),D=s(t[n+2],y,e,a)),r.push(u.clone()),r.push(y.clone()),r.push(E),r.push(D),r.push(E.clone()),r.push(y.clone());break}case 2:{w||(u=t[n].clone(),y=s(u,t[n+1],e,a),E=s(u,t[n+2],e,a),r.push(u),r.push(y),r.push(E)),b||(u=t[n+1].clone(),y=s(u,t[n+2],e,a),E=s(u,t[n],e,a),r.push(u),r.push(y),r.push(E)),m||(u=t[n+2].clone(),y=s(u,t[n],e,a),E=s(u,t[n+1],e,a),r.push(u),r.push(y),r.push(E));break}}}return r}function s(t,e,r,a){const n=t.position.dot(r)-a,w=e.position.dot(r)-a,b=n/(n-w);return new C(new P(t.position.x+b*(e.position.x-t.position.x),t.position.y+b*(e.position.y-t.position.y),t.position.z+b*(e.position.z-t.position.z)),new P(t.normal.x+b*(e.normal.x-t.normal.x),t.normal.y+b*(e.normal.y-t.normal.y),t.normal.z+b*(e.normal.z-t.normal.z)))}}}class C{constructor(l,f){this.position=l,this.normal=f}clone(){return new this.constructor(this.position.clone(),this.normal.clone())}}const U=o=>o===Object(o)&&!Array.isArray(o)&&typeof o!="function";function W(o,l){const f=Z(g=>g.gl),p=G(j,U(o)?Object.values(o):o);if(c.useLayoutEffect(()=>{l==null||l(p)},[l]),c.useEffect(()=>{"initTexture"in f&&(Array.isArray(p)?p:[p]).forEach(f.initTexture)},[f,p]),U(o)){const g=Object.keys(o),x={};return g.forEach(A=>Object.assign(x,{[A]:p[g.indexOf(A)]})),x}else return p}W.preload=o=>G.preload(j,o);W.clear=o=>G.clear(j,o);function ot(o){return Array.isArray(o)}function T(o=[0,0,0]){return ot(o)?o:o instanceof P||o instanceof H?[o.x,o.y,o.z]:[o,o,o]}const rt=c.forwardRef(function({debug:l,depthTest:f=!1,polygonOffsetFactor:p=-10,map:g,mesh:x,children:A,position:B,rotation:i,scale:O,...z},k){const M=c.useRef(null);c.useImperativeHandle(k,()=>M.current);const h=c.useRef(null);return c.useLayoutEffect(()=>{const s=(x==null?void 0:x.current)||M.current.parent,t=M.current;if(!(s instanceof q))throw new Error('Decal must have a Mesh as parent or specify its "mesh" prop');const e={position:new P,rotation:new H,scale:new P(1,1,1)};if(s){I(e,{position:B,scale:O});const r=s.matrixWorld.clone();if(s.matrixWorld.identity(),!i||typeof i=="number"){const a=new K;a.position.copy(e.position),a.lookAt(s.position),typeof i=="number"&&a.rotateZ(i),I(e,{rotation:a.rotation})}else I(e,{rotation:i});return t.geometry=new et(s,e.position,e.rotation,e.scale),h.current&&(I(h.current,e),h.current.traverse(a=>a.raycast=()=>null)),s.matrixWorld=r,()=>{t.geometry.dispose()}}},[x,...T(B),...T(O),...T(i)]),c.createElement("mesh",N({ref:M,"material-transparent":!0,"material-polygonOffset":!0,"material-polygonOffsetFactor":p,"material-depthTest":f,"material-map":g},z),A,l&&c.createElement("mesh",{ref:h},c.createElement("boxGeometry",null),c.createElement("meshNormalMaterial",{wireframe:!0}),c.createElement("axesHelper",null)))}),nt=c.forwardRef(({children:o,enabled:l=!0,speed:f=1,rotationIntensity:p=1,floatIntensity:g=1,floatingRange:x=[-.1,.1],...A},B)=>{const i=c.useRef(null),O=c.useRef(Math.random()*1e4);return Q(z=>{var k,M;if(!l||f===0)return;const h=O.current+z.clock.getElapsedTime();i.current.rotation.x=Math.cos(h/4*f)/8*p,i.current.rotation.y=Math.sin(h/4*f)/8*p,i.current.rotation.z=Math.sin(h/4*f)/20*p;let s=Math.sin(h/4*f)/10;s=Y.mapLinear(s,-.1,.1,(k=x==null?void 0:x[0])!==null&&k!==void 0?k:-.1,(M=x==null?void 0:x[1])!==null&&M!==void 0?M:.1),i.current.position.y=s*g,i.current.updateMatrix()}),c.createElement("group",A,c.createElement("group",{ref:J([i,B]),matrixAutoUpdate:!1},o))}),at=o=>{const[l]=W([o.imgUrl]);return d.createElement(nt,{speed:1.75,rotationIntensity:.2,floatIntensity:.2},d.createElement("mesh",{scale:2.75},d.createElement("icosahedronGeometry",{args:[1,1]}),o.isMobile?d.createElement("meshBasicMaterial",{color:"#fff8eb",roughness:.5,metalness:.1}):d.createElement("meshLambertMaterial",{color:"#fff8eb",roughness:.5,metalness:.1,clipShadows:!0}),d.createElement(rt,{position:[0,0,1],rotation:[2*Math.PI,0,6.25],scale:1,map:l,opacity:.9})))},it=({icon:o})=>{const[l,f]=c.useState(!1);return console.log("ðŸ¦‡ ~ BallCanvas ~ isMobile:",l),c.useEffect(()=>{const p=window.innerWidth;f(p<=500)},[]),d.createElement(v,{frameloop:"demand",dpr:[1,l?1:2],gl:{preserveDrawingBuffer:!0}},d.createElement(c.Suspense,{fallback:d.createElement(V,null)},!l&&d.createElement(d.Fragment,null,d.createElement("ambientLight",{intensity:.25}),d.createElement("directionalLight",{position:[0,0,.03]})),d.createElement(tt,{enableZoom:!1,enablePan:!1,minAzimuthAngle:-Math.PI/4,maxAzimuthAngle:Math.PI/4,minPolarAngle:Math.PI/2-Math.PI/18,maxPolarAngle:Math.PI/2+Math.PI/18,enableDamping:!0,dampingFactor:.05,target:[0,0,0]}),o&&d.createElement(at,{imgUrl:o,isMobile:l})))};export{it as default};
